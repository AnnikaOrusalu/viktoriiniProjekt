<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Online Quiz">
    <meta name="keywords" content="quiz">
    <meta name="author" content="Annika, Erik, Lauri">
    <title>Online Viktoriin | Mängima</title>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
<header>
    <div class="container">
        <div id="branding">
            <h1><span class="highlight">Online</span> Viktoriin</h1>
        </div>
        <nav>
            <ul>
                <li><a href="index.html">esileht</a></li>
                <li class="current"><a href="m2ngima.html">mängima</a></li>
                <li><a href="admin.html">admin</a></li>
            </ul>
        </nav>
    </div>
</header>


<section id="main">
    <div class="container">
        <article id="main-col">
            <h1 class="page-title">Alusta mängu!</h1>
            <ul id="services">
                <li>
                    <h3>Vali õige vastsus ja kliki jätka!</h3>
                    <!--                    <p>Mängu lõpus saad teada tulemuse.</p>-->
                </li>
            </ul>
        </article>

        <aside id="sidebar">
            <div class="dark">
                <h3><input id="question" type="text" disabled></h3>
                <form class="quote">
                    <div>
                        <label>Vastus 1:</label><br>
                        <input type="radio" id="answerButton1" name="checker" value=0>
                        <input id="answer1" type="text" disabled>
                    </div>
                    <div>
                        <label>Vastus 2:</label><br>
                        <input type="radio" id="answerButton2" name="checker" value=1>
                        <input id="answer2" type="text" disabled>
                    </div>
                    <div>
                        <label>Vastus 3:</label><br>
                        <input type="radio" id="answerButton3" name="checker" value=2>
                        <input id="answer3" type="text" disabled>
                    </div>
                    <div>
                        <label>Vastus 4:</label><br>
                        <input type="radio" id="answerButton4" name="checker" value=3>
                        <input id="answer4" type="text" disabled>
                    </div>
                    <br>
                    <button class="button_1" type="button" onclick="clickTheButton()">Enter</button>
                    <div>
                        <label>Sinu pakkumine oli:</label><br>
                        <input id="answerWasRightOrWrong" type="text" disabled>
                    </div>
                </form>
            </div>
        </aside>
    </div>
</section>


<script>

    let postUrl = '/quiz/test'
    let postUrl2 = '/quiz/buttonValue'

    function getQuestionsAndAnswers() {
        fetch(postUrl)
            .then(result => result.json())
            .then(function (result) {
                // question text
                let questionElement = document.getElementById("question");
                questionElement.value = result.questionText;
                // answer text
                let answer1Element = document.getElementById("answer1");
                let answer2Element = document.getElementById("answer2");
                let answer3Element = document.getElementById("answer3");
                let answer4Element = document.getElementById("answer4");
                // buttons
                let button1Element = document.getElementById("answerButton1");
                let button2Element = document.getElementById("answerButton2");
                let button3Element = document.getElementById("answerButton3");
                let button4Element = document.getElementById("answerButton4");
                // answersId assigned to a button
                button1Element.value = result.answerTexts[0].id;
                button2Element.value = result.answerTexts[1].id;
                button3Element.value = result.answerTexts[2].id;
                button4Element.value = result.answerTexts[3].id;
                // answer text on corresponding fields
                answer1Element.value = result.answerTexts[0].text;
                answer2Element.value = result.answerTexts[1].text;
                answer3Element.value = result.answerTexts[2].text;
                answer4Element.value = result.answerTexts[3].text;
            })

    }

    getQuestionsAndAnswers()

    function clickTheButton() {

        let ele = document.getElementsByName('checker');
        let buttonValue = 0;
        for (let i = 0; i < ele.length; i++) {
            // KUI element kohal i on valitud
            if (ele[i].checked) {
                buttonValue = ele[i].value;
                // SIIS kontrolli kas valitud on õige küsimuse nupp
                // ehk kontrolli kas valitud küsimuse true_false väärtus on 1  või 0
            }
        }
        if (buttonValue == 0) {
            alert("Vali õige vastus!")
        } else {


            let userAnswer = {
                userAnswer: buttonValue,
            }
            fetch(postUrl2,
                {
                    method: 'POST',
                    headers: {
                        'Content-type': 'application/json'
                    },
                    body: JSON.stringify(userAnswer)
                })
                .then(result => result.json())
                .then(function (result) {
                    // answer value
                    let answerElement = document.getElementById("answerWasRightOrWrong");
                    if (result) {
                        answerElement.value = "Tubli!"
                    } else {
                        answerElement.value = "Väga paha!"
                    }
                })
        }

    }

</script>
<footer>
    Vali-IT Quiz Team &copy; 2021
</footer>
</body>
</html>
